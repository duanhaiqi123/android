{"version":3,"file":"web-page.js","sources":["webpack/runtime/compat_get_default_export","webpack/runtime/define_property_getters","webpack/runtime/has_own_property","webpack/runtime/make_namespace_object","../../src/web-page.ts"],"sourcesContent":["// getDefaultExport function for compatibility with non-ESM modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};\n","__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n        }\n    }\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import assert from 'node:assert';\nimport type { Point } from '@midscene/core';\nimport { z } from '@midscene/core';\nimport {\n  AbstractInterface,\n  type DeviceAction,\n  defineAction,\n  defineActionClearInput,\n  defineActionDoubleClick,\n  defineActionDragAndDrop,\n  defineActionHover,\n  defineActionInput,\n  defineActionKeyboardPress,\n  defineActionLongPress,\n  defineActionRightClick,\n  defineActionScroll,\n  defineActionSwipe,\n  defineActionTap,\n} from '@midscene/core/device';\n\nimport { sleep } from '@midscene/core/utils';\nimport type { ElementInfo } from '@midscene/shared/extractor';\nimport { getDebug } from '@midscene/shared/logger';\nimport { transformHotkeyInput } from '@midscene/shared/us-keyboard-layout';\n\nconst debug = getDebug('web:page');\n\nfunction normalizeKeyInputs(value: string | string[]): string[] {\n  const inputs = Array.isArray(value) ? value : [value];\n  const result: string[] = [];\n\n  for (const input of inputs) {\n    if (typeof input !== 'string') {\n      result.push(input as unknown as string);\n      continue;\n    }\n\n    const trimmed = input.trim();\n    if (!trimmed) {\n      result.push(input);\n      continue;\n    }\n\n    let normalized = trimmed;\n    if (normalized.length > 1 && normalized.includes('+')) {\n      normalized = normalized.replace(/\\s*\\+\\s*/g, ' ');\n    }\n    if (/\\s/.test(normalized)) {\n      normalized = normalized.replace(/\\s+/g, ' ');\n    }\n\n    const transformed = transformHotkeyInput(normalized);\n    if (transformed.length === 1 && transformed[0] === '' && trimmed !== '') {\n      result.push(input);\n      continue;\n    }\n    if (transformed.length === 0) {\n      result.push(input);\n      continue;\n    }\n\n    result.push(...transformed);\n  }\n\n  return result;\n}\n\nexport function getKeyCommands(\n  value: string | string[],\n): Array<{ key: string; command?: string }> {\n  const keys = normalizeKeyInputs(value);\n\n  return keys.reduce((acc: Array<{ key: string; command?: string }>, k) => {\n    const includeMeta = keys.includes('Meta') || keys.includes('Control');\n    if (includeMeta && (k === 'a' || k === 'A')) {\n      return acc.concat([{ key: k, command: 'SelectAll' }]);\n    }\n    if (includeMeta && (k === 'c' || k === 'C')) {\n      return acc.concat([{ key: k, command: 'Copy' }]);\n    }\n    if (includeMeta && (k === 'v' || k === 'V')) {\n      return acc.concat([{ key: k, command: 'Paste' }]);\n    }\n    return acc.concat([{ key: k }]);\n  }, []);\n}\n\n// this is copied from puppeteer, but we don't want to import puppeteer here\nexport declare type KeyInput =\n  | '0'\n  | '1'\n  | '2'\n  | '3'\n  | '4'\n  | '5'\n  | '6'\n  | '7'\n  | '8'\n  | '9'\n  | 'Power'\n  | 'Eject'\n  | 'Abort'\n  | 'Help'\n  | 'Backspace'\n  | 'Tab'\n  | 'Numpad5'\n  | 'NumpadEnter'\n  | 'Enter'\n  | '\\r'\n  | '\\n'\n  | 'ShiftLeft'\n  | 'ShiftRight'\n  | 'ControlLeft'\n  | 'ControlRight'\n  | 'AltLeft'\n  | 'AltRight'\n  | 'Pause'\n  | 'CapsLock'\n  | 'Escape'\n  | 'Convert'\n  | 'NonConvert'\n  | 'Space'\n  | 'Numpad9'\n  | 'PageUp'\n  | 'Numpad3'\n  | 'PageDown'\n  | 'End'\n  | 'Numpad1'\n  | 'Home'\n  | 'Numpad7'\n  | 'ArrowLeft'\n  | 'Numpad4'\n  | 'Numpad8'\n  | 'ArrowUp'\n  | 'ArrowRight'\n  | 'Numpad6'\n  | 'Numpad2'\n  | 'ArrowDown'\n  | 'Select'\n  | 'Open'\n  | 'PrintScreen'\n  | 'Insert'\n  | 'Numpad0'\n  | 'Delete'\n  | 'NumpadDecimal'\n  | 'Digit0'\n  | 'Digit1'\n  | 'Digit2'\n  | 'Digit3'\n  | 'Digit4'\n  | 'Digit5'\n  | 'Digit6'\n  | 'Digit7'\n  | 'Digit8'\n  | 'Digit9'\n  | 'KeyA'\n  | 'KeyB'\n  | 'KeyC'\n  | 'KeyD'\n  | 'KeyE'\n  | 'KeyF'\n  | 'KeyG'\n  | 'KeyH'\n  | 'KeyI'\n  | 'KeyJ'\n  | 'KeyK'\n  | 'KeyL'\n  | 'KeyM'\n  | 'KeyN'\n  | 'KeyO'\n  | 'KeyP'\n  | 'KeyQ'\n  | 'KeyR'\n  | 'KeyS'\n  | 'KeyT'\n  | 'KeyU'\n  | 'KeyV'\n  | 'KeyW'\n  | 'KeyX'\n  | 'KeyY'\n  | 'KeyZ'\n  | 'MetaLeft'\n  | 'MetaRight'\n  | 'ContextMenu'\n  | 'NumpadMultiply'\n  | 'NumpadAdd'\n  | 'NumpadSubtract'\n  | 'NumpadDivide'\n  | 'F1'\n  | 'F2'\n  | 'F3'\n  | 'F4'\n  | 'F5'\n  | 'F6'\n  | 'F7'\n  | 'F8'\n  | 'F9'\n  | 'F10'\n  | 'F11'\n  | 'F12'\n  | 'F13'\n  | 'F14'\n  | 'F15'\n  | 'F16'\n  | 'F17'\n  | 'F18'\n  | 'F19'\n  | 'F20'\n  | 'F21'\n  | 'F22'\n  | 'F23'\n  | 'F24'\n  | 'NumLock'\n  | 'ScrollLock'\n  | 'AudioVolumeMute'\n  | 'AudioVolumeDown'\n  | 'AudioVolumeUp'\n  | 'MediaTrackNext'\n  | 'MediaTrackPrevious'\n  | 'MediaStop'\n  | 'MediaPlayPause'\n  | 'Semicolon'\n  | 'Equal'\n  | 'NumpadEqual'\n  | 'Comma'\n  | 'Minus'\n  | 'Period'\n  | 'Slash'\n  | 'Backquote'\n  | 'BracketLeft'\n  | 'Backslash'\n  | 'BracketRight'\n  | 'Quote'\n  | 'AltGraph'\n  | 'Props'\n  | 'Cancel'\n  | 'Clear'\n  | 'Shift'\n  | 'Control'\n  | 'Alt'\n  | 'Accept'\n  | 'ModeChange'\n  | ' '\n  | 'Print'\n  | 'Execute'\n  | '\\u0000'\n  | 'a'\n  | 'b'\n  | 'c'\n  | 'd'\n  | 'e'\n  | 'f'\n  | 'g'\n  | 'h'\n  | 'i'\n  | 'j'\n  | 'k'\n  | 'l'\n  | 'm'\n  | 'n'\n  | 'o'\n  | 'p'\n  | 'q'\n  | 'r'\n  | 's'\n  | 't'\n  | 'u'\n  | 'v'\n  | 'w'\n  | 'x'\n  | 'y'\n  | 'z'\n  | 'Meta'\n  | '*'\n  | '+'\n  | '-'\n  | '/'\n  | ';'\n  | '='\n  | ','\n  | '.'\n  | '`'\n  | '['\n  | '\\\\'\n  | ']'\n  | \"'\"\n  | 'Attn'\n  | 'CrSel'\n  | 'ExSel'\n  | 'EraseEof'\n  | 'Play'\n  | 'ZoomOut'\n  | ')'\n  | '!'\n  | '@'\n  | '#'\n  | '$'\n  | '%'\n  | '^'\n  | '&'\n  | '('\n  | 'A'\n  | 'B'\n  | 'C'\n  | 'D'\n  | 'E'\n  | 'F'\n  | 'G'\n  | 'H'\n  | 'I'\n  | 'J'\n  | 'K'\n  | 'L'\n  | 'M'\n  | 'N'\n  | 'O'\n  | 'P'\n  | 'Q'\n  | 'R'\n  | 'S'\n  | 'T'\n  | 'U'\n  | 'V'\n  | 'W'\n  | 'X'\n  | 'Y'\n  | 'Z'\n  | ':'\n  | '<'\n  | '_'\n  | '>'\n  | '?'\n  | '~'\n  | '{'\n  | '|'\n  | '}'\n  | '\"'\n  | 'SoftLeft'\n  | 'SoftRight'\n  | 'Camera'\n  | 'Call'\n  | 'EndCall'\n  | 'VolumeDown'\n  | 'VolumeUp';\n\nexport type MouseButton = 'left' | 'right' | 'middle';\n\nexport interface MouseAction {\n  click: (\n    x: number,\n    y: number,\n    options: { button: MouseButton; count?: number },\n  ) => Promise<void>;\n  wheel: (deltaX: number, deltaY: number) => Promise<void>;\n  move: (x: number, y: number) => Promise<void>;\n  drag: (\n    from: { x: number; y: number },\n    to: { x: number; y: number },\n  ) => Promise<void>;\n}\n\nexport interface KeyboardAction {\n  type: (text: string) => Promise<void>;\n  press: (\n    action:\n      | { key: KeyInput; command?: string }\n      | { key: KeyInput; command?: string }[],\n  ) => Promise<void>;\n}\n\nexport interface ChromePageDestroyOptions {\n  closeTab?: boolean; // should close the tab when the page object is destroyed\n}\n\nexport abstract class AbstractWebPage extends AbstractInterface {\n  navigate?(url: string): Promise<void>;\n  reload?(): Promise<void>;\n  goBack?(): Promise<void>;\n\n  get mouse(): MouseAction {\n    return {\n      click: async (\n        x: number,\n        y: number,\n        options: { button: MouseButton },\n      ) => {},\n      wheel: async (deltaX: number, deltaY: number) => {},\n      move: async (x: number, y: number) => {},\n      drag: async (\n        from: { x: number; y: number },\n        to: { x: number; y: number },\n      ) => {},\n    };\n  }\n\n  get keyboard(): KeyboardAction {\n    return {\n      type: async (text: string) => {},\n      press: async (\n        action:\n          | { key: KeyInput; command?: string }\n          | { key: KeyInput; command?: string }[],\n      ) => {},\n    };\n  }\n\n  async clearInput(element: ElementInfo): Promise<void> {}\n\n  abstract scrollUntilTop(startingPoint?: Point): Promise<void>;\n  abstract scrollUntilBottom(startingPoint?: Point): Promise<void>;\n  abstract scrollUntilLeft(startingPoint?: Point): Promise<void>;\n  abstract scrollUntilRight(startingPoint?: Point): Promise<void>;\n  abstract scrollUp(distance?: number, startingPoint?: Point): Promise<void>;\n  abstract scrollDown(distance?: number, startingPoint?: Point): Promise<void>;\n  abstract scrollLeft(distance?: number, startingPoint?: Point): Promise<void>;\n  abstract scrollRight(distance?: number, startingPoint?: Point): Promise<void>;\n  abstract longPress(x: number, y: number, duration?: number): Promise<void>;\n  abstract swipe(\n    from: { x: number; y: number },\n    to: { x: number; y: number },\n    duration?: number,\n  ): Promise<void>;\n}\n\nexport const commonWebActionsForWebPage = <T extends AbstractWebPage>(\n  page: T,\n  includeTouchEvents = false,\n): DeviceAction<any>[] => [\n  defineActionTap(async (param) => {\n    const element = param.locate;\n    assert(element, 'Element not found, cannot tap');\n\n    // Pure tap action - file handling is done at Page layer via setFileChooserHandler\n    await page.mouse.click(element.center[0], element.center[1], {\n      button: 'left',\n    });\n  }),\n  defineActionRightClick(async (param) => {\n    const element = param.locate;\n    assert(element, 'Element not found, cannot right click');\n    await page.mouse.click(element.center[0], element.center[1], {\n      button: 'right',\n    });\n  }),\n  defineActionDoubleClick(async (param) => {\n    const element = param.locate;\n    assert(element, 'Element not found, cannot double click');\n\n    await page.mouse.click(element.center[0], element.center[1], {\n      button: 'left',\n      count: 2,\n    });\n  }),\n  defineActionHover(async (param) => {\n    const element = param.locate;\n    assert(element, 'Element not found, cannot hover');\n    await page.mouse.move(element.center[0], element.center[1]);\n  }),\n  defineActionInput(async (param) => {\n    const element = param.locate;\n    if (element && param.mode !== 'append') {\n      await page.clearInput(element as unknown as ElementInfo);\n    }\n\n    if (param.mode === 'clear') {\n      // Clear mode removes existing text without entering new characters\n      return;\n    }\n\n    if (!param || !param.value) {\n      return;\n    }\n\n    // Note: there is another implementation in AndroidDevicePage, which is more complex\n    await page.keyboard.type(param.value);\n  }),\n  defineActionKeyboardPress(async (param) => {\n    const element = param.locate;\n    if (element) {\n      await page.mouse.click(element.center[0], element.center[1], {\n        button: 'left',\n      });\n    }\n\n    const keys = getKeyCommands(param.keyName);\n    await page.keyboard.press(keys as any); // TODO: fix this type error\n  }),\n  defineActionScroll(async (param) => {\n    const element = param.locate;\n    const startingPoint = element\n      ? {\n          left: element.center[0],\n          top: element.center[1],\n        }\n      : undefined;\n    const scrollToEventName = param?.scrollType;\n    if (scrollToEventName === 'scrollToTop') {\n      await page.scrollUntilTop(startingPoint);\n    } else if (scrollToEventName === 'scrollToBottom') {\n      await page.scrollUntilBottom(startingPoint);\n    } else if (scrollToEventName === 'scrollToRight') {\n      await page.scrollUntilRight(startingPoint);\n    } else if (scrollToEventName === 'scrollToLeft') {\n      await page.scrollUntilLeft(startingPoint);\n    } else if (scrollToEventName === 'singleAction' || !scrollToEventName) {\n      if (param?.direction === 'down' || !param || !param.direction) {\n        await page.scrollDown(param?.distance || undefined, startingPoint);\n      } else if (param.direction === 'up') {\n        await page.scrollUp(param.distance || undefined, startingPoint);\n      } else if (param.direction === 'left') {\n        await page.scrollLeft(param.distance || undefined, startingPoint);\n      } else if (param.direction === 'right') {\n        await page.scrollRight(param.distance || undefined, startingPoint);\n      } else {\n        throw new Error(`Unknown scroll direction: ${param.direction}`);\n      }\n      // until mouse event is done\n      await sleep(500);\n    } else {\n      throw new Error(\n        `Unknown scroll event type: ${scrollToEventName}, param: ${JSON.stringify(\n          param,\n        )}`,\n      );\n    }\n  }),\n  defineActionDragAndDrop(async (param) => {\n    const from = param.from;\n    const to = param.to;\n    assert(from, 'missing \"from\" param for drag and drop');\n    assert(to, 'missing \"to\" param for drag and drop');\n    await page.mouse.drag(\n      {\n        x: from.center[0],\n        y: from.center[1],\n      },\n      {\n        x: to.center[0],\n        y: to.center[1],\n      },\n    );\n  }),\n\n  defineActionLongPress(async (param) => {\n    const element = param.locate;\n    assert(element, 'Element not found, cannot long press');\n    const duration = param?.duration;\n    await page.longPress(element.center[0], element.center[1], duration);\n  }),\n\n  ...(includeTouchEvents\n    ? [\n        defineActionSwipe(async (param) => {\n          const { width, height } = await page.size();\n          const { start, end } = param;\n\n          const startPoint = start\n            ? {\n                x: start.center[0],\n                y: start.center[1],\n              }\n            : {\n                x: width / 2,\n                y: height / 2,\n              };\n\n          let endPoint: {\n            x: number;\n            y: number;\n          };\n\n          if (end) {\n            endPoint = {\n              x: end.center[0],\n              y: end.center[1],\n            };\n          } else if (param.distance) {\n            const direction = param.direction;\n            if (!direction) {\n              throw new Error('direction is required for swipe gesture');\n            }\n\n            endPoint = {\n              x:\n                startPoint.x +\n                (direction === 'right'\n                  ? param.distance\n                  : direction === 'left'\n                    ? -param.distance\n                    : 0),\n              y:\n                startPoint.y +\n                (direction === 'down'\n                  ? param.distance\n                  : direction === 'up'\n                    ? -param.distance\n                    : 0),\n            };\n          } else {\n            throw new Error(\n              'Either end or distance must be specified for swipe gesture',\n            );\n          }\n\n          // Ensure end coordinates are within bounds\n          endPoint.x = Math.max(0, Math.min(endPoint.x, width));\n          endPoint.y = Math.max(0, Math.min(endPoint.y, height));\n\n          const duration = param.duration;\n\n          debug(\n            `swipe from ${startPoint.x}, ${startPoint.y} to ${endPoint.x}, ${endPoint.y} with duration ${duration}ms, repeat is set to ${param.repeat}`,\n          );\n          let repeat = typeof param.repeat === 'number' ? param.repeat : 1;\n          if (repeat === 0) {\n            repeat = 10; // 10 times is enough for infinite swipe\n          }\n          for (let i = 0; i < repeat; i++) {\n            await page.swipe(startPoint, endPoint, duration);\n          }\n        }),\n      ]\n    : []),\n\n  defineActionClearInput(async (param) => {\n    const element = param.locate;\n    assert(element, 'Element not found, cannot clear input');\n    await page.clearInput(element as unknown as ElementInfo);\n  }),\n\n  defineAction({\n    name: 'Navigate',\n    description:\n      'Navigate the browser to a specified URL. Opens the URL in the current tab.',\n    paramSchema: z.object({\n      url: z\n        .string()\n        .describe(\n          'The URL to navigate to. Must start with https://, file://, or a similar protocol.',\n        ),\n    }),\n    call: async (param) => {\n      if (!page.navigate) {\n        throw new Error(\n          'Navigate operation is not supported on this page type',\n        );\n      }\n      await page.navigate(param.url);\n    },\n  }),\n\n  defineAction({\n    name: 'Reload',\n    description: 'Reload the current page',\n    call: async () => {\n      if (!page.reload) {\n        throw new Error('Reload operation is not supported on this page type');\n      }\n      await page.reload();\n    },\n  }),\n\n  defineAction({\n    name: 'GoBack',\n    description: 'Navigate back in browser history',\n    call: async () => {\n      if (!page.goBack) {\n        throw new Error('GoBack operation is not supported on this page type');\n      }\n      await page.goBack();\n    },\n  }),\n];\n"],"names":["__webpack_require__","module","getter","definition","key","Object","obj","prop","Symbol","debug","getDebug","normalizeKeyInputs","value","inputs","Array","result","input","trimmed","normalized","transformed","transformHotkeyInput","getKeyCommands","keys","acc","k","includeMeta","AbstractWebPage","AbstractInterface","x","y","options","deltaX","deltaY","from","to","text","action","element","commonWebActionsForWebPage","page","includeTouchEvents","defineActionTap","param","assert","defineActionRightClick","defineActionDoubleClick","defineActionHover","defineActionInput","defineActionKeyboardPress","defineActionScroll","startingPoint","undefined","scrollToEventName","Error","JSON","sleep","defineActionDragAndDrop","defineActionLongPress","duration","defineActionSwipe","width","height","start","end","startPoint","endPoint","direction","Math","repeat","i","defineActionClearInput","defineAction","z"],"mappings":"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"}