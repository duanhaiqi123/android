{"version":3,"file":"puppeteer/index.js","sources":["webpack/runtime/compat_get_default_export","webpack/runtime/define_property_getters","webpack/runtime/has_own_property","webpack/runtime/make_namespace_object","../../../src/puppeteer/index.ts"],"sourcesContent":["// getDefaultExport function for compatibility with non-ESM modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};\n","__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n        }\n    }\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import type { WebPageAgentOpt } from '@/web-element';\nimport { Agent as PageAgent } from '@midscene/core/agent';\nimport { getDebug } from '@midscene/shared/logger';\nimport type { Page as PuppeteerPage } from 'puppeteer';\nimport semver from 'semver';\nimport { getWebpackRequire } from '../utils';\nimport {\n  forceChromeSelectRendering as applyChromeSelectRendering,\n  forceClosePopup,\n} from './base-page';\nimport { PuppeteerWebPage } from './page';\n\nconst debug = getDebug('puppeteer:agent');\n\n/**\n * Get Puppeteer version from package.json\n */\nfunction getPuppeteerVersion(): string | null {\n  try {\n    const puppeteerPkg = getWebpackRequire()('puppeteer/package.json');\n    return puppeteerPkg.version || null;\n  } catch (error) {\n    console.error('[midscene:error] Failed to get Puppeteer version', error);\n    return null;\n  }\n}\n\nexport { PuppeteerWebPage } from './page';\nexport type { WebPageAgentOpt } from '@/web-element';\n\nexport class PuppeteerAgent extends PageAgent<PuppeteerWebPage> {\n  constructor(page: PuppeteerPage, opts?: WebPageAgentOpt) {\n    const webPage = new PuppeteerWebPage(page, opts);\n    super(webPage, opts);\n\n    const { forceSameTabNavigation = true, forceChromeSelectRendering } =\n      opts ?? {};\n\n    if (forceSameTabNavigation) {\n      forceClosePopup(page, debug);\n    }\n\n    if (forceChromeSelectRendering) {\n      const puppeteerVersion = getPuppeteerVersion();\n      if (puppeteerVersion && !semver.gte(puppeteerVersion, '24.6.0')) {\n        console.warn(\n          `[midscene:error] forceChromeSelectRendering requires Puppeteer > 24.6.0, but current version is ${puppeteerVersion}. This feature may not work correctly.`,\n        );\n      }\n      applyChromeSelectRendering(page);\n    }\n  }\n}\n\nexport { overrideAIConfig } from '@midscene/shared/env';\n\n// Do NOT export this since it requires puppeteer\n// export { puppeteerAgentForTarget } from './agent-launcher';\n"],"names":["__webpack_require__","module","getter","definition","key","Object","obj","prop","Symbol","debug","getDebug","getPuppeteerVersion","puppeteerPkg","getWebpackRequire","error","console","PuppeteerAgent","PageAgent","page","opts","webPage","PuppeteerWebPage","forceSameTabNavigation","forceChromeSelectRendering","forceClosePopup","puppeteerVersion","semver","applyChromeSelectRendering"],"mappings":";;;IACAA,oBAAoB,CAAC,GAAG,CAACC;QACxB,IAAIC,SAASD,UAAUA,OAAO,UAAU,GACvC,IAAOA,MAAM,CAAC,UAAU,GACxB,IAAOA;QACRD,oBAAoB,CAAC,CAACE,QAAQ;YAAE,GAAGA;QAAO;QAC1C,OAAOA;IACR;;;ICPAF,oBAAoB,CAAC,GAAG,CAAC,UAASG;QACjC,IAAI,IAAIC,OAAOD,WACR,IAAGH,oBAAoB,CAAC,CAACG,YAAYC,QAAQ,CAACJ,oBAAoB,CAAC,CAAC,UAASI,MACzEC,OAAO,cAAc,CAAC,UAASD,KAAK;YAAE,YAAY;YAAM,KAAKD,UAAU,CAACC,IAAI;QAAC;IAGzF;;;ICNAJ,oBAAoB,CAAC,GAAG,CAACM,KAAKC,OAAUF,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAACC,KAAKC;;;ICClFP,oBAAoB,CAAC,GAAG,CAAC;QACxB,IAAG,AAAkB,eAAlB,OAAOQ,UAA0BA,OAAO,WAAW,EACrDH,OAAO,cAAc,CAAC,UAASG,OAAO,WAAW,EAAE;YAAE,OAAO;QAAS;QAEtEH,OAAO,cAAc,CAAC,UAAS,cAAc;YAAE,OAAO;QAAK;IAC5D;;;;;;;;;;;;;;;;;ACMA,MAAMI,QAAQC,AAAAA,IAAAA,uBAAAA,QAAAA,AAAAA,EAAS;AAKvB,SAASC;IACP,IAAI;QACF,MAAMC,eAAeC,AAAAA,IAAAA,kCAAAA,iBAAAA,AAAAA,IAAoB;QACzC,OAAOD,aAAa,OAAO,IAAI;IACjC,EAAE,OAAOE,OAAO;QACdC,QAAQ,KAAK,CAAC,oDAAoDD;QAClE,OAAO;IACT;AACF;AAKO,MAAME,uBAAuBC,sBAAAA,KAASA;IAC3C,YAAYC,IAAmB,EAAEC,IAAsB,CAAE;QACvD,MAAMC,UAAU,IAAIC,iCAAAA,gBAAgBA,CAACH,MAAMC;QAC3C,KAAK,CAACC,SAASD;QAEf,MAAM,EAAEG,yBAAyB,IAAI,EAAEC,0BAA0B,EAAE,GACjEJ,QAAQ,CAAC;QAEX,IAAIG,wBACFE,AAAAA,IAAAA,sCAAAA,eAAAA,AAAAA,EAAgBN,MAAMT;QAGxB,IAAIc,4BAA4B;YAC9B,MAAME,mBAAmBd;YACzB,IAAIc,oBAAoB,CAACC,0BAAAA,GAAU,CAACD,kBAAkB,WACpDV,QAAQ,IAAI,CACV,CAAC,gGAAgG,EAAEU,iBAAiB,sCAAsC,CAAC;YAG/JE,IAAAA,sCAAAA,0BAAAA,AAAAA,EAA2BT;QAC7B;IACF;AACF"}