import { AbstractInterface } from '@midscene/core/device';
import type { ActionParam } from '@midscene/core';
import type { ActionReturn } from '@midscene/core';
import { ADB } from 'appium-adb';
import { Agent } from '@midscene/core/agent';
import { AgentOpt } from '@midscene/core/agent';
import { AndroidDeviceInputOpt } from '@midscene/core/device';
import { AndroidDeviceOpt } from '@midscene/core/device';
import { Device } from 'appium-adb';
import { DeviceAction } from '@midscene/core';
import type { ElementInfo } from '@midscene/shared/extractor';
import { InterfaceType } from '@midscene/core';
import { overrideAIConfig } from '@midscene/shared/env';
import { Point } from '@midscene/core';
import { Size } from '@midscene/core';
import { z } from '@midscene/core';

declare type ActionArgs<T extends DeviceAction> = [ActionParam<T>] extends [undefined] ? [] : [ActionParam<T>];

export declare function agentFromAdbDevice(deviceId?: string, opts?: AndroidAgentOpt & AndroidDeviceOpt): Promise<AndroidAgent>;

export declare class AndroidAgent extends Agent<AndroidDevice> {
    /**
     * Launch an Android app or URL
     */
    launch: WrappedAction<DeviceActionLaunch>;
    /**
     * Execute ADB shell command on Android device
     */
    runAdbShell: WrappedAction<DeviceActionRunAdbShell>;
    /**
     * Trigger the system back operation on Android devices
     */
    back: WrappedAction<DeviceActionAndroidBackButton>;
    /**
     * Trigger the system home operation on Android devices
     */
    home: WrappedAction<DeviceActionAndroidHomeButton>;
    /**
     * Trigger the system recent apps operation on Android devices
     */
    recentApps: WrappedAction<DeviceActionAndroidRecentAppsButton>;
    constructor(device: AndroidDevice, opts?: AndroidAgentOpt);
    private createActionWrapper;
}

export declare type AndroidAgentOpt = AgentOpt;

export declare class AndroidDevice implements AbstractInterface {
    private deviceId;
    private yadbPushed;
    private devicePixelRatio;
    private devicePixelRatioInitialized;
    private scalingRatio;
    private adb;
    private connectingAdb;
    private destroyed;
    private description;
    private customActions?;
    private cachedScreenSize;
    private cachedOrientation;
    interfaceType: InterfaceType;
    uri: string | undefined;
    options?: AndroidDeviceOpt;
    actionSpace(): DeviceAction<any>[];
    constructor(deviceId: string, options?: AndroidDeviceOpt);
    describe(): string;
    connect(): Promise<ADB>;
    getAdb(): Promise<ADB>;
    private createAdbProxy;
    launch(uri: string): Promise<AndroidDevice>;
    execYadb(keyboardContent: string): Promise<void>;
    getElementsInfo(): Promise<ElementInfo[]>;
    getElementsNodeTree(): Promise<any>;
    getScreenSize(): Promise<{
        override: string;
        physical: string;
        orientation: number;
        isCurrentOrientation?: boolean;
    }>;
    private initializeDevicePixelRatio;
    getDisplayDensity(): Promise<number>;
    getDisplayOrientation(): Promise<number>;
    size(): Promise<Size>;
    private adjustCoordinates;
    /**
     * Calculate the end point for scroll operations based on start point, scroll delta, and screen boundaries.
     * This method ensures that scroll operations stay within screen bounds and maintain a minimum scroll distance
     * for effective scrolling gestures on Android devices.
     *
     * @param start - The starting point of the scroll gesture
     * @param deltaX - The horizontal scroll distance (positive = scroll right, negative = scroll left)
     * @param deltaY - The vertical scroll distance (positive = scroll down, negative = scroll up)
     * @param maxWidth - The maximum width boundary (screen width)
     * @param maxHeight - The maximum height boundary (screen height)
     * @returns The calculated end point for the scroll gesture
     */
    private calculateScrollEndPoint;
    screenshotBase64(): Promise<string>;
    clearInput(element: ElementInfo): Promise<void>;
    forceScreenshot(path: string): Promise<void>;
    url(): Promise<string>;
    scrollUntilTop(startPoint?: Point): Promise<void>;
    scrollUntilBottom(startPoint?: Point): Promise<void>;
    scrollUntilLeft(startPoint?: Point): Promise<void>;
    scrollUntilRight(startPoint?: Point): Promise<void>;
    scrollUp(distance?: number, startPoint?: Point): Promise<void>;
    scrollDown(distance?: number, startPoint?: Point): Promise<void>;
    scrollLeft(distance?: number, startPoint?: Point): Promise<void>;
    scrollRight(distance?: number, startPoint?: Point): Promise<void>;
    ensureYadb(): Promise<void>;
    keyboardType(text: string, options?: AndroidDeviceInputOpt): Promise<void>;
    private normalizeKeyName;
    keyboardPress(key: string): Promise<void>;
    mouseClick(x: number, y: number): Promise<void>;
    mouseDoubleClick(x: number, y: number): Promise<void>;
    mouseMove(): Promise<void>;
    mouseDrag(from: {
        x: number;
        y: number;
    }, to: {
        x: number;
        y: number;
    }, duration?: number): Promise<void>;
    scroll(deltaX: number, deltaY: number, duration?: number): Promise<void>;
    destroy(): Promise<void>;
    back(): Promise<void>;
    home(): Promise<void>;
    recentApps(): Promise<void>;
    longPress(x: number, y: number, duration?: number): Promise<void>;
    pullDown(startPoint?: Point, distance?: number, duration?: number): Promise<void>;
    pullDrag(from: {
        x: number;
        y: number;
    }, to: {
        x: number;
        y: number;
    }, duration: number): Promise<void>;
    pullUp(startPoint?: Point, distance?: number, duration?: number): Promise<void>;
    private getDisplayArg;
    getPhysicalDisplayId(): Promise<string | null>;
    hideKeyboard(options?: AndroidDeviceInputOpt, timeoutMs?: number): Promise<boolean>;
}

declare type DeviceActionAndroidBackButton = DeviceAction<undefined, void>;

declare type DeviceActionAndroidHomeButton = DeviceAction<undefined, void>;

declare type DeviceActionAndroidRecentAppsButton = DeviceAction<undefined, void>;

declare type DeviceActionLaunch = DeviceAction<LaunchParam, void>;

declare type DeviceActionRunAdbShell = DeviceAction<RunAdbShellParam, string>;

export declare function getConnectedDevices(): Promise<Device[]>;

declare type LaunchParam = z.infer<typeof launchParamSchema>;

declare const launchParamSchema: z.ZodString;

export { overrideAIConfig }

declare type RunAdbShellParam = z.infer<typeof runAdbShellParamSchema>;

/**
 * Platform-specific action definitions for Android
 * Single source of truth for both runtime behavior and type definitions
 */
declare const runAdbShellParamSchema: z.ZodString;

/**
 * Helper type to convert DeviceAction to wrapped method signature
 */
declare type WrappedAction<T extends DeviceAction> = (...args: ActionArgs<T>) => Promise<ActionReturn<T>>;

export { }
