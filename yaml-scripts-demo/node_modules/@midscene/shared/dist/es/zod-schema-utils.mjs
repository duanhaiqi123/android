function unwrapZodField(field) {
    const f = field;
    if (!f._def) return f;
    const typeName = f._def.typeName;
    if ('ZodOptional' === typeName || 'ZodNullable' === typeName || 'ZodDefault' === typeName) return unwrapZodField(f._def.innerType);
    if ('ZodEffects' === typeName) {
        if (f._def.schema) return unwrapZodField(f._def.schema);
    }
    return f;
}
function isMidsceneLocatorField(field) {
    const actualField = unwrapZodField(field);
    if (actualField._def?.typeName === 'ZodObject') {
        const shape = actualField._def.shape?.();
        if (shape) {
            if ('midscene_location_field_flag' in shape) return true;
            if ('prompt' in shape && shape.prompt) return true;
        }
    }
    return false;
}
function getZodTypeName(field, locatorTypeDescription) {
    const actualField = unwrapZodField(field);
    const fieldTypeName = actualField._def?.typeName;
    if ('ZodString' === fieldTypeName) return 'string';
    if ('ZodNumber' === fieldTypeName) return 'number';
    if ('ZodBoolean' === fieldTypeName) return 'boolean';
    if ('ZodArray' === fieldTypeName) return 'array';
    if ('ZodObject' === fieldTypeName) {
        if (isMidsceneLocatorField(actualField)) return locatorTypeDescription || 'object';
        return 'object';
    }
    if ('ZodEnum' === fieldTypeName) {
        const values = actualField._def?.values?.map((option)=>String(`'${option}'`)).join(', ') ?? 'enum';
        return `enum(${values})`;
    }
    if ('ZodUnion' === fieldTypeName) {
        const options = actualField._def?.options;
        if (options && options.length > 0) {
            const types = options.map((opt)=>getZodTypeName(opt, locatorTypeDescription));
            return types.join(' | ');
        }
        return 'union';
    }
    return 'unknown';
}
function getZodDescription(field) {
    if ("description" in field) return field.description || null;
    const actualField = unwrapZodField(field);
    if ("description" in actualField) return actualField.description || null;
    if (isMidsceneLocatorField(actualField)) return 'Location information for the target element';
    return null;
}
export { getZodDescription, getZodTypeName, isMidsceneLocatorField, unwrapZodField };
